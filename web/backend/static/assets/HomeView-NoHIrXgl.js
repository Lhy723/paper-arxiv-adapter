import{d as z,c as Q,a as N,T as R,w as X,b as J,o as r,e as u,f as e,g as T,t as a,F as f,r as w,h as _,i as S,j as b,_ as H,k as q,v as O,l as W,m as M,n as d,p as Y}from"./index-DKN7MZcg.js";import{p as B}from"./api-D9h__T2_.js";const Z={class:"preview-header"},ee={class:"preview-badge"},se={class:"preview-content"},te={class:"preview-title"},oe={class:"preview-authors"},le={class:"preview-categories"},ne={class:"preview-abstract"},ae={class:"preview-meta"},ie={class:"meta-item"},re={class:"meta-value"},ue={class:"preview-actions"},ce={key:1,class:"saved-badge"},ve=["href"],de=z({__name:"PaperPreview",props:{visible:{type:Boolean},paper:{},saved:{type:Boolean}},emits:["close","save"],setup(c){const v=c,g=b(()=>{if(!v.paper)return"";const n=v.paper.authors;return n.length<=3?n.join(", "):`${n.slice(0,3).join(", ")} 等 ${n.length} 位作者`}),y=b(()=>{if(!v.paper)return"";const n=v.paper.abstract||"";return n.length<=400?n:n.slice(0,400)+"..."});function p(n){if(!n)return"-";try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}return(n,o)=>(r(),Q(J,{to:"body"},[N(R,{name:"fade"},{default:X(()=>[c.visible&&c.paper?(r(),u("div",{key:0,class:"preview-overlay",onClick:o[3]||(o[3]=i=>n.$emit("close"))},[e("div",{class:"preview-modal",onClick:o[2]||(o[2]=T(()=>{},["stop"]))},[e("header",Z,[e("span",ee,a(c.paper.arxiv_id)+a(c.paper.version),1),e("button",{class:"close-btn",onClick:o[0]||(o[0]=i=>n.$emit("close"))},[...o[4]||(o[4]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",se,[e("h2",te,a(c.paper.title),1),e("div",oe,[o[5]||(o[5]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e("circle",{cx:"9",cy:"7",r:"4"})],-1)),e("span",null,a(g.value),1)]),e("div",le,[(r(!0),u(f,null,w(c.paper.categories.slice(0,4),i=>(r(),u("span",{key:i,class:"category-tag"},a(i),1))),128))]),e("div",ne,[o[6]||(o[6]=e("h3",null,"摘要",-1)),e("p",null,a(y.value),1)]),e("div",ae,[e("div",ie,[o[7]||(o[7]=e("span",{class:"meta-label"},"发布日期",-1)),e("span",re,a(p(c.paper.published)),1)])])]),e("footer",ue,[c.saved?(r(),u("span",ce,[...o[9]||(o[9]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"20 6 9 17 4 12"})],-1),_(" 已保存 ",-1)])])):(r(),u("button",{key:0,class:"btn-cta",onClick:o[1]||(o[1]=i=>n.$emit("save"))},[...o[8]||(o[8]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1),_(" 保存到数据库 ",-1)])])),e("a",{href:c.paper.pdf_url,target:"_blank",rel:"noopener noreferrer",class:"btn-secondary"},[...o[10]||(o[10]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})],-1),_(" PDF ",-1)])],8,ve)])])])):S("",!0)]),_:1})]))}}),pe=H(de,[["__scopeId","data-v-1c6c201c"]]),he={class:"home-view"},ye={class:"search-section"},ke={class:"search-box"},fe=["disabled"],ge={class:"search-options"},me={class:"option-group"},we={class:"option-group"},_e={class:"quick-tags"},be=["onClick"],Ce={key:0,class:"loading-section"},$e={class:"results-header"},xe={class:"results-info"},qe={class:"results-count"},Be={class:"selection-actions"},Se={class:"select-all"},De=["checked"],Pe={class:"results-list"},Ve={class:"result-checkbox"},Me=["checked","onChange"],ze=["onClick"],Ne={class:"result-header"},Te={class:"arxiv-id"},He={class:"result-date"},Fe={class:"result-title"},je={class:"result-authors"},Ae={class:"result-abstract"},Ke={class:"result-categories"},Le={class:"result-actions"},Ue=["onClick"],Ee={key:2,class:"empty-section"},Ie=z({__name:"HomeView",setup(c){const v=d(""),g=d("relevance"),y=d(10),p=d(!1),n=d(!1),o=d([]),i=d(new Set),C=d(new Set),$=d(!1),m=d(null),F=["machine learning","deep learning","NLP","computer vision","transformer","GPT"],D=b(()=>o.value.length>0&&o.value.every(t=>i.value.has(t.unique_key)));function P(t){return i.value.has(t)}function j(t){return t?C.value.has(t):!1}function A(t){i.value.has(t.unique_key)?i.value.delete(t.unique_key):i.value.add(t.unique_key)}function K(){D.value?i.value.clear():o.value.forEach(t=>i.value.add(t.unique_key))}const k=b(()=>o.value.filter(t=>i.value.has(t.unique_key)));async function x(){if(v.value.trim()){p.value=!0,n.value=!1,i.value.clear();try{const{data:t}=await B.search(v.value,y.value);o.value=t.papers.map(s=>({...s,unique_key:`${s.arxiv_id}${s.version}`})),n.value=!0}catch(t){console.error("Search failed:",t)}finally{p.value=!1}}}function L(t){v.value=t,x()}function V(t){m.value=t,$.value=!0}async function U(t){if(t)try{await B.batchSave([t]),C.value.add(t.unique_key),i.value.delete(t.unique_key)}catch(s){console.error("Failed to save paper:",s)}}async function E(){if(k.value.length!==0)try{await B.batchSave(k.value),k.value.forEach(t=>{C.value.add(t.unique_key)}),i.value.clear()}catch(t){console.error("Failed to save papers:",t)}}function I(t,s){return t?t.length>s?t.slice(0,s)+"...":t:""}function G(t){if(!t)return"";try{return new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return t}}return(t,s)=>(r(),u("div",he,[s[17]||(s[17]=e("header",{class:"hero"},[e("h1",null,"ArXiv Paper Adapter"),e("p",{class:"hero-desc"},"搜索、发现、管理学术论文")],-1)),e("section",ye,[e("div",ke,[s[5]||(s[5]=e("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1)),q(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>v.value=l),placeholder:"搜索论文标题、作者或关键词...",onKeyup:W(x,["enter"]),class:"search-input"},null,544),[[O,v.value]]),e("button",{onClick:x,class:"search-btn",disabled:p.value}," 搜索 ",8,fe)]),e("div",ge,[e("div",me,[s[7]||(s[7]=e("label",null,"排序方式",-1)),q(e("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>g.value=l)},[...s[6]||(s[6]=[e("option",{value:"relevance"},"相关性",-1),e("option",{value:"submittedDate"},"发布日期",-1),e("option",{value:"lastUpdatedDate"},"更新日期",-1)])],512),[[M,g.value]])]),e("div",we,[s[9]||(s[9]=e("label",null,"每页显示",-1)),q(e("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>y.value=l)},[...s[8]||(s[8]=[e("option",{value:10},"10 条",-1),e("option",{value:20},"20 条",-1),e("option",{value:50},"50 条",-1)])],512),[[M,y.value]])])]),e("div",_e,[s[10]||(s[10]=e("span",{class:"tag-label"},"热门搜索：",-1)),(r(),u(f,null,w(F,l=>e("button",{key:l,onClick:h=>L(l),class:"quick-tag"},a(l),9,be)),64))])]),p.value?(r(),u("section",Ce,[...s[11]||(s[11]=[e("div",{class:"spinner"},null,-1),e("span",null,"搜索中...",-1)])])):o.value.length>0?(r(),u(f,{key:1},[e("section",$e,[e("div",xe,[s[12]||(s[12]=e("h2",null,"搜索结果",-1)),e("span",qe,"共 "+a(o.value.length)+" 篇论文",1)]),e("div",Be,[e("label",Se,[e("input",{type:"checkbox",checked:D.value,onChange:K},null,40,De),s[13]||(s[13]=e("span",null,"全选",-1))]),k.value.length>0?(r(),u("button",{key:0,class:"btn-cta",onClick:E},[s[14]||(s[14]=e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),_(" 保存选中 ("+a(k.value.length)+") ",1)])):S("",!0)])]),e("div",Pe,[(r(!0),u(f,null,w(o.value,l=>(r(),u("div",{key:l.unique_key,class:Y(["result-item",{selected:P(l.unique_key)}])},[e("div",Ve,[e("input",{type:"checkbox",checked:P(l.unique_key),onChange:h=>A(l)},null,40,Me)]),e("div",{class:"result-content",onClick:h=>V(l)},[e("div",Ne,[e("span",Te,a(l.arxiv_id)+a(l.version),1),e("span",He,a(G(l.published)),1)]),e("h3",Fe,a(l.title),1),e("p",je,a(l.authors.slice(0,3).join(", "))+a(l.authors.length>3?` 等 ${l.authors.length} 位`:""),1),e("p",Ae,a(I(l.abstract,200)),1),e("div",Ke,[(r(!0),u(f,null,w(l.categories.slice(0,3),h=>(r(),u("span",{key:h,class:"category-tag"},a(h),1))),128))])],8,ze),e("div",Le,[e("button",{class:"preview-btn",onClick:T(h=>V(l),["stop"])},[...s[15]||(s[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)])],8,Ue)])],2))),128))])],64)):n.value?(r(),u("section",Ee,[...s[16]||(s[16]=[e("svg",{class:"empty-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1),e("p",null,"未找到相关论文",-1),e("p",{class:"empty-hint"},"尝试使用不同的关键词搜索",-1)])])):S("",!0),N(pe,{visible:$.value,paper:m.value,saved:j(m.value?.unique_key),onClose:s[3]||(s[3]=l=>$.value=!1),onSave:s[4]||(s[4]=l=>U(m.value))},null,8,["visible","paper","saved"])]))}}),Re=H(Ie,[["__scopeId","data-v-8a4c2238"]]);export{Re as default};
