import{d as L,e as r,f as e,F as y,r as P,t as u,j as b,o as i,p as N,_ as T,q as H,s as X,k as V,v as A,m as E,a as O,h as B,g as D,i as q,n as g,u as Q}from"./index-DKN7MZcg.js";import{p as z}from"./api-D9h__T2_.js";const R={class:"pagination"},G=["disabled"],J={class:"page-numbers"},K=["disabled","onClick"],W=["disabled"],Y={class:"page-info"},Z=L({__name:"Pagination",props:{total:{},pageSize:{},currentPage:{}},emits:["update:currentPage"],setup(h,{emit:C}){const c=h,k=C,v=b(()=>Math.ceil(c.total/c.pageSize)),f=b(()=>{const a=[],l=v.value,o=c.currentPage;if(l<=7)for(let d=1;d<=l;d++)a.push(d);else o<=3?a.push(1,2,3,4,"...",l):o>=l-2?a.push(1,"...",l-3,l-2,l-1,l):a.push(1,"...",o-1,o,o+1,"...",l);return a});function p(a){a>=1&&a<=v.value&&a!==c.currentPage&&k("update:currentPage",a)}return(a,l)=>(i(),r("div",R,[e("button",{class:"page-btn",disabled:h.currentPage===1,onClick:l[0]||(l[0]=o=>p(h.currentPage-1))},[...l[2]||(l[2]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1)])],8,G),e("div",J,[(i(!0),r(y,null,P(f.value,o=>(i(),r("button",{key:o,class:N(["page-num",{active:o===h.currentPage,ellipsis:o==="..."}]),disabled:o==="...",onClick:d=>o!=="..."&&p(o)},u(o),11,K))),128))]),e("button",{class:"page-btn",disabled:h.currentPage===v.value,onClick:l[1]||(l[1]=o=>p(h.currentPage+1))},[...l[3]||(l[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)])],8,W),e("span",Y," 共 "+u(h.total)+" 条 ",1)]))}}),ee=T(Z,[["__scopeId","data-v-7b99fd99"]]),te={class:"papers-view"},se={class:"page-header"},le={class:"header-actions"},ne={class:"paper-count"},oe={class:"controls-bar"},ae={class:"search-filter"},re={class:"sort-controls"},ie={key:0,class:"loading-state"},ue={key:1,class:"empty-state"},de={class:"table-container"},ce={class:"papers-table"},ve=["onClick"],pe={class:"arxiv-id"},ge={class:"paper-title"},he={class:"paper-authors"},fe={class:"category-tags"},ke={key:0,class:"more-tag"},me={class:"date"},ye=["onClick"],be=["onClick"],Ce={class:"modal-actions"},_=15,we=L({__name:"PapersView",setup(h){const C=Q(),c=g([]),k=g(!0),v=g(""),f=g("created_at"),p=g("desc"),a=g(1),l=g(0),o=g(!1),d=g(null),w=b(()=>{if(!v.value)return c.value;const s=v.value.toLowerCase();return c.value.filter(t=>t.title.toLowerCase().includes(s)||t.authors.some(n=>n.toLowerCase().includes(s)))}),F=b(()=>{const s=(a.value-1)*_;return w.value.slice(s,s+_)});function I(){p.value=p.value==="asc"?"desc":"asc"}function M(s,t){return s.length>t?s.slice(0,t)+"...":s}function S(s){if(!s)return"-";try{return new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return s}}function x(s){C.push(`/papers/${s}`)}function U(s){d.value=s,o.value=!0}async function j(){if(d.value)try{await z.delete(d.value.unique_key),c.value=c.value.filter(s=>s.unique_key!==d.value.unique_key),l.value--,o.value=!1,d.value=null}catch(s){console.error("Failed to delete paper:",s)}}async function $(){k.value=!0;try{const{data:s}=await z.list(1e3,0,f.value,p.value);c.value=s.papers,l.value=s.total}catch(s){console.error("Failed to load papers:",s)}finally{k.value=!1}}return H([f,p],()=>{$()}),X($),(s,t)=>(i(),r("div",te,[e("div",se,[t[7]||(t[7]=e("div",{class:"header-content"},[e("h1",null,"论文数据库"),e("p",{class:"page-desc"},"管理本地存储的论文数据")],-1)),e("div",le,[e("span",ne,u(l.value)+" 篇论文",1)])]),e("div",oe,[e("div",ae,[t[8]||(t[8]=e("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"M21 21l-4.35-4.35"})],-1)),V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>v.value=n),placeholder:"搜索标题或作者...",class:"search-input"},null,512),[[A,v.value]])]),e("div",re,[V(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>f.value=n),class:"sort-select"},[...t[9]||(t[9]=[e("option",{value:"created_at"},"添加时间",-1),e("option",{value:"title"},"标题",-1),e("option",{value:"published"},"发布日期",-1),e("option",{value:"arxiv_id"},"arXiv ID",-1)])],512),[[E,f.value]]),e("button",{class:N(["order-btn",{asc:p.value==="asc"}]),onClick:I},[...t[10]||(t[10]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 4h13M3 8h9M3 12h5"}),e("path",{d:"M17 8l4 4-4 4"})],-1)])],2)])]),k.value?(i(),r("div",ie,[...t[11]||(t[11]=[e("div",{class:"spinner"},null,-1),e("span",null,"加载论文列表...",-1)])])):w.value.length===0?(i(),r("div",ue,[t[12]||(t[12]=e("svg",{class:"empty-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("p",null,u(v.value?"未找到匹配的论文":"数据库为空"),1),t[13]||(t[13]=e("p",{class:"empty-hint"},"前往搜索页面添加论文",-1))])):(i(),r(y,{key:2},[e("div",de,[e("table",ce,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"arXiv ID"),e("th",null,"标题"),e("th",null,"作者"),e("th",null,"分类"),e("th",null,"添加时间"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),r(y,null,P(F.value,n=>(i(),r("tr",{key:n.unique_key,onClick:m=>x(n.unique_key),class:"paper-row"},[e("td",null,[e("span",pe,u(n.arxiv_id)+u(n.version),1)]),e("td",null,[e("span",ge,u(M(n.title,50)),1)]),e("td",null,[e("span",he,u(M(n.authors.join(", "),30)),1)]),e("td",null,[e("div",fe,[(i(!0),r(y,null,P(n.categories.slice(0,2),m=>(i(),r("span",{key:m,class:"category-tag"},u(m),1))),128)),n.categories.length>2?(i(),r("span",ke," +"+u(n.categories.length-2),1)):q("",!0)])]),e("td",null,[e("span",me,u(S(n.published)),1)]),e("td",null,[e("div",{class:"actions",onClick:t[2]||(t[2]=D(()=>{},["stop"]))},[e("button",{class:"action-btn",onClick:m=>x(n.unique_key),title:"查看详情"},[...t[14]||(t[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)])],8,ye),e("button",{class:"action-btn danger",onClick:m=>U(n),title:"删除"},[...t[15]||(t[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,be)])])],8,ve))),128))])])]),O(ee,{total:w.value.length,"page-size":_,"current-page":a.value,"onUpdate:currentPage":t[3]||(t[3]=n=>a.value=n)},null,8,["total","current-page"])],64)),o.value?(i(),r("div",{key:3,class:"modal-overlay",onClick:t[6]||(t[6]=n=>o.value=!1)},[e("div",{class:"modal",onClick:t[5]||(t[5]=D(()=>{},["stop"]))},[t[19]||(t[19]=e("h3",null,"确认删除",-1)),e("p",null,[t[17]||(t[17]=B("确定要删除论文 ",-1)),e("strong",null,u(d.value?.title),1),t[18]||(t[18]=B(" 吗？",-1))]),e("div",Ce,[e("button",{class:"btn-secondary",onClick:t[4]||(t[4]=n=>o.value=!1)},"取消"),e("button",{class:"btn-danger",onClick:j},"删除")])])])):q("",!0)]))}}),Me=T(we,[["__scopeId","data-v-46d4ab7a"]]);export{Me as default};
